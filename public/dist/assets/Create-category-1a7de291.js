import{V as m}from"./vacancy.service-906fc0e3.js";import{_ as h,o,c as u,w as s,n as c,a as t,a8 as f,a4 as b,i as d,af as v,d as p,b as n,a5 as w,F as k,a9 as I,aa as S}from"./index-a1344df0.js";import{V as C}from"./index-9f9beae4.js";import{b as F,c as V,V as M}from"./VTextField-a51d04a5.js";import{V as $}from"./VList-9ab19358.js";import{V as U}from"./VListItem-365efae1.js";import{V as q}from"./VSpacer-60265fd4.js";import{V as A}from"./VDivider-3035ff69.js";import"./lazy-cc59aaa1.js";const _={data:()=>({type_of_document:null,name:"",description:"",companies:[],categoryId:1,categories:[],category:"",valid:!1,valid2:!1,show:!1,rules:{required:e=>!!e||"Поле обязательно для заполнения"},snackbar:!1,snackbarMessage:""}),methods:{submitForm(){this.valid&&this.createAdv()},async getCategoryId(e){const i=this.categories.find(r=>r.title==this.category);this.categoryId=i.id},async createAdv(){if(this.name!=null&&this.description!=null){let e={name:this.name,description:this.description,jwt:localStorage.getItem("jwt"),creator:localStorage.getItem("email"),modifeir:localStorage.getItem("email"),email:localStorage.getItem("email")},a=await m.createCategory(e);a.err?(this.snackbar=!0,this.snackbarMessage=a.err):localStorage.getItem("jwt")!=null&&(this.$route.params.nextUrl!=null?this.$router.push(this.$route.params.nextUrl):this.loadMyAdverts())}},async loadMyAdverts(){let e={email:localStorage.getItem("email")},a=await m.allVacancies(e);if(a.err)console.log("Empty my_adverts list");else{console.log(a);const i=a.categories.map(r=>({title:r.name,id:r.id,desc:r.description}));this.companies=i,setTimeout(()=>{this.show=!0},300)}}},beforeCreate(){localStorage.getItem("jwt")==null&&this.$router.push("/")},async created(){await this.loadMyAdverts()}},j={key:0,class:"my-box"};function B(e,a,i,r,T,g){return o(),u(c,null,{default:s(()=>[t(C,null,{default:s(()=>[e.show?(o(),f("div",j,[t(b,{class:"align-center"},{default:s(()=>[t(d,{title:"Добавить компанию (общие сведения)",class:"mx-auto","max-width":"700",variant:"outlined"},{default:s(()=>[t(c,{class:"align-center"},{default:s(()=>[t(F,{ref:"form1",modelValue:e.valid,"onUpdate:modelValue":a[2]||(a[2]=l=>e.valid=l),"lazy-validation":"",onSubmit:v(g.submitForm,["prevent"])},{default:s(()=>[t(V,{modelValue:e.name,"onUpdate:modelValue":a[0]||(a[0]=l=>e.name=l),label:"Название категории",rules:[e.rules.required],"hide-details":"",required:""},null,8,["modelValue","rules"]),t(V,{modelValue:e.description,"onUpdate:modelValue":a[1]||(a[1]=l=>e.description=l),label:"Описание, подразделы",rules:[e.rules.required],"hide-details":"",required:""},null,8,["modelValue","rules"]),t(p,{density:"comfortable",class:"mt-4",color:"success",type:"submit",disabled:!e.valid,block:""},{default:s(()=>[n(" Добавить компанию ")]),_:1},8,["disabled"])]),_:1},8,["modelValue","onSubmit"]),t(p,{size:"x-small",variant:"plain"},{default:s(()=>[n(" *Обязательное поле ")]),_:1}),t(M,{modelValue:e.snackbar,"onUpdate:modelValue":a[3]||(a[3]=l=>e.snackbar=l)},{default:s(()=>[n(w(e.snackbarMessage),1)]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(d,{class:"mx-auto mt-4","max-width":"700",variant:"outlined"},{default:s(()=>[t(d,{title:"Список компаний",class:"mx-auto","max-width":"700"},{default:s(()=>[t($,{lines:"one"},{default:s(()=>[(o(!0),f(k,null,I(e.companies,(l,y)=>(o(),u(U,{key:y,title:l.title,subtitle:l.desc},{default:s(()=>[t(q),t(A)]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})])):S("",!0)]),_:1})]),_:1})}const J=h(_,[["render",B]]);export{J as default};
